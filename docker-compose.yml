services:
  ollama:
    image: ollama/ollama:latest
    container_name: recallai-ollama
    ports:
    - 11434:11434
    volumes:
    - ollama_data:/root/.ollama
    healthcheck:
      test:
      - CMD
      - ollama
      - list
      interval: 10s
      timeout: 5s
      retries: 5
  recallai:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: recallai-app
    ports:
    - 8000:8000
    volumes:
    - /Users/pavithradevim/projects/Learnings/notes/:/data/folder_0:ro
    - ./indexes:/app/indexes
    - ./models:/app/models
    - ./logs:/app/logs
    - ./config.docker.yaml:/app/config.yaml
    environment:
    - OLLAMA_BASE_URL=http://ollama:11434
    depends_on:
      ollama:
        condition: service_healthy
    restart: unless-stopped
volumes:
  ollama_data:
    driver: local
